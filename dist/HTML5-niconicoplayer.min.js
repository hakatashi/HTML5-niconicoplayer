!function e(t,n,r){function o(s,c){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!c&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var a=n[s]={exports:{}};t[s][0].call(a.exports,function(e){var n=t[s][1][e];return o(n?n:e)},a,a.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){var r,o,i,s,c,u=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};s=e("core-js/library/fn/array/find"),c=e("core-js/library/fn/array/find-index"),i={commentList:!1,commentTime:4,commentPreTime:1,commentHeight:20,commentFile:!1},o=["white","red","pink","orange","yellow","green","cyan","blue","purple","black"],r=void 0,r=function(e){var t,n,r,s,a,f,l,m,d,p,h,v,y;if(p=videojs.util.mergeOptions(i,e),d=this,p.commentPostTime=p.commentTime-p.commentPreTime,s=!1,p.commentList&&(r=document.querySelector(p.commentList)),f=d.contentEl(),y=f.querySelector("video")||f.querySelector("iframe"),p.commentFile)n=p.commentFile;else{for(v=y.querySelectorAll("track"),t=[],l=0,m=v.length;m>l;l++)h=v[l],h.classList.contains("vjs-niconico-comment-file")&&t.push(h);if(0===t.length)throw new Error("Niconico Comment file not found");n=t[0].getAttribute("src")}return a=null,d.ready(function(){var e,t,i,f,l,m,h,v;return v=new XMLHttpRequest,v.overrideMimeType("text/xml"),v.open("GET",n,!0),v.send(),e=document.createElement("div"),e.className="vjs-niconico-comment-area",h=Math.floor(y.offsetHeight/p.commentHeight),m=function(){var e,t,n;for(n=[],i=e=0,t=h;t>=0?t>e:e>t;i=t>=0?++e:--e)n.push(0);return n}(),f=0,l=0,t=[],y.parentNode.insertBefore(e,y.nextSibling),v.onload=function(){var n,y,x,g,$,w,T,b,M,j,C,N,E,A,P,S,q,I,k,F,H;if(200!==v.status)throw new Error("Server responded with status code "+v.status);if(null===v.responseXML)throw new Error("Comment file is broken");for(s=!0,a=v.responseXML,q=a.querySelector("packet"),g=q.querySelectorAll("chat"),$=[],M=0,A=g.length;A>M;M++)x=g[M],y={},y.element=x,y.text=x.textContent,y.date=new Date(1e3*parseInt(x.getAttribute("date"))),y.thread=parseInt(x.getAttribute("thread")),y.userId=x.getAttribute("user_id"),y.mail=x.getAttribute("mail"),y.styles=y.mail?y.mail.split(" "):[],y.vpos=parseInt(x.getAttribute("vpos")),$.push(y);if($.sort(function(e,t){return e.vpos-t.vpos}),r)for(j=0,P=$.length;P>j;j++)y=$[j],w=document.createElement("div"),w.className="vjs-comment",r.appendChild(w),T=document.createElement("div"),T.className="vjs-comment-text",T.textContent=y.text,w.appendChild(T),S=("00"+Math.floor(y.vpos/6e3)).slice(-2),F=("00"+Math.floor(y.vpos/100)%60).slice(-2),n=("00"+Math.floor(y.vpos)%6e3).slice(-2),b=document.createElement("div"),b.className="vjs-comment-time",b.textContent=S+":"+F+"."+n,w.appendChild(b),y.listElement=w;return k=function(e){var t;return r?(y=$[e],t=y.listElement.offsetTop-r.offsetTop-r.offsetHeight,r.scrollTop=Math.max(0,t)):void 0},I=function(e){var t;return r?(t=c($,function(t){return t.vpos>100*e}),k(t)):void 0},setInterval(function(){return d.paused()?void 0:(F=d.currentTime(),I(F))},100),setInterval(function(){return H()},33),C=function(t,n){var r,i,s,c,a,l,h,v,y,x,g,$,T,b,M,j,C,N,E,A,P;if(P=d.currentTime(),A=d.width(),P-p.commentPostTime<(M=t.vpos/100)&&M<P+p.commentPreTime){for(N=P+p.commentPreTime-t.vpos/100,w=document.createElement("span"),w.className="vjs-niconico-comment",w.textContent=t.text,e.appendChild(w),s=w.offsetWidth,C=A+s,j=C/p.commentTime*N,i=A-j,c=t.vpos/100-p.commentPreTime+p.commentTime/C*A,b=[],y=null,a=x=0,l=m.length;l>x;a=++x){if(E=m[a],c>=E){y=a;break}b[a]=E-c}if(null===y)for(g=1/0,a=$=0,h=b.length;h>$;a=++$)E=b[a],g>E&&(g=E,y=a);for(w.dataset.line=y,w.dataset.index=n,w.dataset.width=s,w.style.top=y*p.commentHeight+"px",w.style.left=i+"px",T=0,v=o.length;v>T;T++)r=o[T],u.call(t.styles,r)>=0&&(w.className+=" "+r);m[a]=t.vpos/100+p.commentPostTime}return t.vpos/100<P+p.commentPreTime?f=Math.max(f,n):void 0},E=function(n,r){var i,s,c,a,f,m,h,v,y,x,g,$,T,b,M,j,C,N,E,A,P,S,q,I;if(I=d.currentTime(),q=d.width(),S=d.height(),I-p.commentTime<(P=n.vpos/100)&&I>P){if(f=I-n.vpos/100,w=document.createElement("span"),w.className="vjs-niconico-comment fixed",w.textContent=n.text,a=p.commentHeight,i=function(e,n){var r,o,i,s,c,u;for(u=0,i=0,o=t.length;o>i;i++)r=t[i],s=Math.max(e,r.from),c=Math.min(n,r.to),c>s&&(u+=c-s);return u},E=null,u.call(n.styles,"ue")>=0)if(w.className+=" ue",t.sort(function(e,t){return e.to-t.to}),0===i(0,a))E=0;else{for(C=[],$=0,h=t.length;h>$;$++)if(c=t[$],j=i(c.to,c.to+a),C.push(j),c.to+a<=S&&0===j){E=c.to;break}if(null===E){for(T=1/0,m=b=0,v=C.length;v>b;m=++b)j=C[m],T>j&&t[m].to+a<=S&&(T=j,E=t[m].to);null===E&&(E=0)}}else if(w.className+=" shita",t.sort(function(e,t){return t.from-e.from}),0===i(S-a,S))E=S-a;else{for(C=[],M=0,y=t.length;y>M;M++)if(c=t[M],j=i(c.from-a,c.from),C.push(j),c.from-a>=0&&0===j){E=c.from-a;break}if(null===E){for(T=1/0,m=N=0,x=C.length;x>N;m=++N)j=C[m],T>j&&t[m].from-a>=0&&(T=j,E=t[m].from-a);null===E&&(E=S-a)}}for(w.dataset.index=r,w.style.top=E+"px",A=0,g=o.length;g>A;A++)s=o[A],u.call(n.styles,s)>=0&&(w.className+=" "+s);e.appendChild(w),t.push({from:E,to:E+a,index:r})}return n.vpos/100<I?l=Math.max(l,r):void 0},N=function(){var n,r,o,s;for(e.innerHTML="",m=function(){var e,t,n;for(n=[],i=e=0,t=h;t>=0?t>e:e>t;i=t>=0?++e:--e)n.push(0);return n}(),f=0,l=0,t=[],s=[],n=o=0,r=$.length;r>o;n=++o)y=$[n],u.call(y.styles,"ue")>=0||u.call(y.styles,"shita")>=0?s.push(E(y,n)):s.push(C(y,n));return s},H=function(){var n,r,o,i,s,c,a,m,h,v,x,g,T,b,M,j,N,A;for(A=d.currentTime(),N=d.width(),g=[],x=e.childNodes,m=0,s=x.length;s>m;m++)w=x[m],i=parseInt(w.dataset.index),y=$[i],u.call(y.styles,"ue")>=0||u.call(y.styles,"shita")>=0?y.vpos/100<A-p.commentTime&&(g.push(w),t=t.filter(function(e){return e.index!==i})):y.vpos/100<A-p.commentPostTime?g.push(w):(j=A+p.commentPreTime-y.vpos/100,r=parseInt(w.dataset.width),M=N+r,b=M/p.commentTime*j,n=N-b,w.style.left=n+"px");for(h=0,c=g.length;c>h;h++)o=g[h],o.parentNode.removeChild(o);for(T=[],i=v=0,a=$.length;a>v;i=++v)y=$[i],u.call(y.styles,"ue")>=0||u.call(y.styles,"shita")>=0?i>l?T.push(E(y,i)):T.push(void 0):i>f?T.push(C(y,i)):T.push(void 0);return T},d.on("seeked",function(){return N()}),N(),window.layoutComments=N,window.updateComment=H}}),d},videojs.plugin("HTML5Niconicoplayer",r)},{"core-js/library/fn/array/find":3,"core-js/library/fn/array/find-index":2}],2:[function(e,t,n){e("../../modules/es6.array.find-index"),t.exports=e("../../modules/$.core").Array.findIndex},{"../../modules/$.core":7,"../../modules/es6.array.find-index":17}],3:[function(e,t,n){e("../../modules/es6.array.find"),t.exports=e("../../modules/$.core").Array.find},{"../../modules/$.core":7,"../../modules/es6.array.find":18}],4:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],5:[function(e,t,n){var r=e("./$.ctx"),o=e("./$.iobject"),i=e("./$.to-object"),s=e("./$.to-length");t.exports=function(e){var t=1==e,n=2==e,c=3==e,u=4==e,a=6==e,f=5==e||a;return function(l,m,d){for(var p,h,v=i(l),y=o(v),x=r(m,d,3),g=s(y.length),$=0,w=t?Array(g):n?[]:void 0;g>$;$++)if((f||$ in y)&&(p=y[$],h=x(p,$,v),e))if(t)w[$]=h;else if(h)switch(e){case 3:return!0;case 5:return p;case 6:return $;case 2:w.push(p)}else if(u)return!1;return a?-1:c||u?u:w}}},{"./$.ctx":8,"./$.iobject":12,"./$.to-length":14,"./$.to-object":15}],6:[function(e,t,n){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],7:[function(e,t,n){var r=t.exports={};"number"==typeof __e&&(__e=r)},{}],8:[function(e,t,n){var r=e("./$.a-function");t.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":4}],9:[function(e,t,n){var r=e("./$.global"),o=e("./$.core"),i="prototype",s=function(e,t){return function(){return e.apply(t,arguments)}},c=function(e,t,n){var u,a,f,l,m=e&c.G,d=e&c.P,p=m?r:e&c.S?r[t]:(r[t]||{})[i],h=m?o:o[t]||(o[t]={});m&&(n=t);for(u in n)a=!(e&c.F)&&p&&u in p,a&&u in h||(f=a?p[u]:n[u],m&&"function"!=typeof p[u]?l=n[u]:e&c.B&&a?l=s(f,r):e&c.W&&p[u]==f?!function(e){l=function(t){return this instanceof e?new e(t):e(t)},l[i]=e[i]}(f):l=d&&"function"==typeof f?s(Function.call,f):f,h[u]=l,d&&((h[i]||(h[i]={}))[u]=f))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,t.exports=c},{"./$.core":7,"./$.global":11}],10:[function(e,t,n){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],11:[function(e,t,n){var r="undefined",o=t.exports=typeof window!=r&&window.Math==Math?window:typeof self!=r&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=o)},{}],12:[function(e,t,n){var r=e("./$.cof");t.exports=0 in Object("z")?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{"./$.cof":6}],13:[function(e,t,n){var r=Math.ceil,o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?o:r)(e)}},{}],14:[function(e,t,n){var r=e("./$.to-integer"),o=Math.min;t.exports=function(e){return e>0?o(r(e),9007199254740991):0}},{"./$.to-integer":13}],15:[function(e,t,n){var r=e("./$.defined");t.exports=function(e){return Object(r(e))}},{"./$.defined":10}],16:[function(e,t,n){t.exports=function(){}},{}],17:[function(e,t,n){"use strict";var r="findIndex",o=e("./$.def"),i=!0,s=e("./$.array-methods")(6);r in[]&&Array(1)[r](function(){i=!1}),o(o.P+o.F*i,"Array",{findIndex:function(e){return s(this,e,arguments[1])}}),e("./$.unscope")(r)},{"./$.array-methods":5,"./$.def":9,"./$.unscope":16}],18:[function(e,t,n){"use strict";var r="find",o=e("./$.def"),i=!0,s=e("./$.array-methods")(5);r in[]&&Array(1)[r](function(){i=!1}),o(o.P+o.F*i,"Array",{find:function(e){return s(this,e,arguments[1])}}),e("./$.unscope")(r)},{"./$.array-methods":5,"./$.def":9,"./$.unscope":16}]},{},[1]);
//# sourceMappingURL=HTML5-niconicoplayer.min.js.map